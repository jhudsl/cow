
# Candace Savonen Dec 2021

name: Update Googlesheet

# Triggers the workflow on pull requests for the main branch OR can be manually triggered
on:
  workflow_dispatch:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  update:
    runs-on: ubuntu-latest
    container:
      image: jhudsl/course-library

    steps:
      # Checks-out the code from this repo
      - name: Checkout code from repo
        uses: actions/checkout@v2

      # Get auth tokens
      - name: Get token
        run: |
          echo ${{ secrets.GH_PAT }} > git_token.txt
          mkdir .secrets
          curl -s -O https://${GH_PAT}@raw.githubusercontent.com/cansavvy/secret-secrets/main/9566fe0643cfe888fecd0b72f870afec_cansav09%40gmail.com > .secrets/9566fe0643cfe888fecd0b72f870afec_cansav09@gmail.com

      # Run main function
      - name: Run build update googlesheet
        run: |
          Rscript --vanilla update-googlesheet.R

          rm -r .secrets
